# 데드락
- 두 개 이상의 프로세스 혹은 스레드가 서로가 가진 리소스를 기다리는 상태

## 데드락을 만드는 네가지 조건
- 아래 네가지 조건을 모두 만족하면 데드락이 발생한다.
1. 상호 배제 `Mutual exclusion`
    - 리소스를 공유해서 사용할 수 없다.
    - 한번에 하나의 프로세스 / 스레드만 점유할 수 있다. 
2. 점유 대기 `Hold and wait`
    - 프로세스가 이미 하나 이상의 리소스를 취득한(hold) 상태에서
    - 다른 프로세스가 사용하고 있는 리소스를 추가로 기다린다.(wait)
3. 비선점 `No preemption`
    - 리소스 반환(release)은 오직 해당 리소스를 취득한 프로세스 / 스레드만 할 수 있다.
    - 즉, 다른 프로세스의 작업이 끝날 때 까지 리소스를 뺏을 수 없다.
4. 순환 대기`Circular wait`
    - 프로세스들이 순환 (circular) 형태로 서로의 리소스를 기다린다.
   
## OS의 데드락 해결 방법
### 1. 데드락 방지 (deadlock prevention)
- 위 네가지 조건 중 하나가 충족되지 않게 시스템을 디자인
1. Mutual exclusion
  - 리소스를 공유 가능하게 한다.
  - 이 방법은 거의 불가능하다. 개발에서도 우리가 이유가 있어서 임계 영역 생성을 하고 락을 쥐고 반환하도록 설계하는 경우가 다반사이기 때문
2. Hold and wait
  - 사용할 리소스들을 모두 획득한 뒤에 시작 혹은 리소스를 전혀 가지지 않은 상태에서만 리소스 요청하도록 제약
  - 이 방법은 다음과 같은 단점이 있다.
  - 만약 여러 리소스를 획득하고 차례로 진행하고 있는데 작업이 길어지면 획득했던 남은 리소스는 놀게되어 리소스 효율성 저하
  - 만약 획득하려는 리소스가 인기가 많은 리소스라면 확보가 쉽지 않아 무한히 대기할 수도 있다. (Starvation - 기아현상)
3. No preemption
  - 추가적인 리소스를 기다려야 하는 상황에서 내가 이미 획득한 리소스를 다른 프로세스가 요청을 하면 쥐고 있는 리소스를 다른 프로세스가 선점 가능하도록 한다.
    - context switching과 비슷함.
4. Circular wait
  - 모든 리소스에 순서 체계를 부여해서 오름차순으로 리소스를 요청
  - 이 방식이 데드락 방지를 위해 많이 사용하는 방식이라고 함.

<br>

### 2.데드락 회피 (deadlock avoidance)
- OS가 동작하면서 사용 가능한 리소스들, 할당된 리소스, 다음 작업에 필요한 리소스 등 추가적인 정보를 활용해서 데드락이 발생할 것 같은 상황을 회피하는 것
- 데드락 회피로 유명한 `은행원 알고리즘 (Banker algorithm)`이 있다.

<br>

### 3. 데드락 감지와 복구

<br>

### 4. 데드락 무시
