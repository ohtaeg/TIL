# S3 Storage Classes (S3 티어)
- `S3 Standard`
  - 범용으로 사용되는 가장 기초적인 저장소
  - 99.99% 가용성
  - 99.999999999% 내구성
  - 여러 장소에 분산 보관 (다중 AZ)
  - 기능 장애를 동시에 두 개 버틸 수 있어 AZ 재해에 강하다.
  - 빅 데이터 분석, 모바일과 게임 어플리케이션 배포 등에 사용
- `S3 -IA` (infrequently Accessed)
  - 자주 사용되지 않는 데이터를 빠르게 엑세스 해야하는 경우
  - 저렴한 가격에 보관
  - 보관 비용은 S3 Standard보다 쌈, 대신 데이터를 불러올 때마다 비용 지불
  - 최소 128KB 이상 객체만 저장 가능
  - 최소 30일 데이터 보관 가능
  - 기능 장애를 동시에 두 개 버틸 수 있어 AZ 재해에 강하다.
  - 재해 복구나 백업 등에 사용
- `S3 - One Zone IA`
  - IA와 같으나 하나의 AZ에 먼저 저장된다.
  - 단일 AZ에 대해서는 내구성이 같지만 해당 AZ가 손상되면 데이터를 잃게된다.
  - 덜 중요하고 자주 사용되지 않는 데이터 (이미지 썸네일 등)
  - 지연 시간이 짧고 높은 처리량을 기대할 수 있다.
  - IA보다 더 저렴하고 IA보다 가용성이 떨어진다.
    - 99.9 vs 99.5 (가용 영역을 하나만 사용해서)
  - 모든 암호화에 SSL을 지원
  - 즉시 조회 가능
  - 최소 128KB 이상 객체만 저장 가능
  - 최소 30일 데이터 보관 가능
  - 2차 백업, 재생성 가능한 데이터 저장용
    - 재생성이란 이미지의 원본을 다른곳에 저장하고 썸네일을 OZ IA에 저장하는 식을 말함
- `S3 Intelligent Tiering`
  - 머신 러닝을 사용해 자동으로 티어 변경
  - S3 Standard와 마찬가지로 지연시간이 짧고 처리량이 높음, 퍼포먼스 손해/오버헤드 없음
  - 월간 모니터링 비용과 자동 티어 이동 비용이 발생
- `S3 Glacier` (빙하)
  - 오랫동안 저장하고 접근하지 않는 데이터를 저장
  - 아카이브/백업 저장소
    - 각 아키이브 크기는 40TB
    - 버킷이 아닌 금고에 저장
  - 저렴한 가격
  - 최소 40KB 이상 객체만 저장 가능
  - 수십년 기간동안 데이터 보관 (최소 90일 ~ 최대 10년)
  - 회수 옵션은 3가지이다. 파일 요청하면 돌려받기까지
    - `Expedited (1 to 5 Minute)` 긴급용, 가장 비쌈
    - `Standard (3 to 5 Hours)`
    - `Bulk (5 to 12 Hours)`
- `S3 Glacier Deep Archive`
  - 아주 장기간 저장을 위한 스토리지, 즉시 필요하지 않는 아카이브용
  - 매우 쌈
  - `Standard (12 Hours)`
    - 12시간 이전에는 파일 회수 불가능
  - `Bulk (48 Hours)`
  - 최소 180일 저장
  - 최소 40KB 이상 객체만 저장 가능

![스토리지 클래스들](./img/storage-classes.png)

<br>

## S3 Select & Glacier Select
- SQL을 통해 서버 필터링을 수행하여 적은 데이터 회수 가능
- 행과 열로 필터링 수행
- 집계 등의 기능은 수행 불가능
- 전체 파일을 회수하는 것이 아니기 때문에 네트워크와 CPU 비용 절감
- 비용도 절감

<br>

## 스토리지 클래스간 전환(이동)
- 자주 엑세스하는 객체의 경우 Standard, IA로 이동
- 객체 클래스 이동은 수동도 가능하지만 `수명 주기 정책`을 통해 자동으로 가능

<br>

## S3 수명 주기
- "일정 시간이 지난 후 ~~ 을 해라" 라는 명령
  - 예, 30일이 지난 후 삭제
  - 예, 30일이 지난 후 Glacier로 옮기기 (클래스간 전환)
- 버전과 연동 가능
  - 예전 버전과 현재 버전에 대해 설정 가능
- 완료되지 않은 멀티파트 업로드를 정리하는데도 사용
- 특정 접두어에 규칙을 적용할 수 있다.
  - ex) MP3 폴더에 있는 파일들 삭제 
- 파일이 업로드 / 삭제 / 업데이트 되었을 떄 이벤트 호출 가능 (Lambda, SQS, SNS 등)